var app=function(){"use strict";function t(){}function e(t){return t()}function n(){return Object.create(null)}function o(t){t.forEach(e)}function r(t){return"function"==typeof t}function s(t,e){return t!=t?e==e:t!==e||t&&"object"==typeof t||"function"==typeof t}let l,c;function u(t,e){return l||(l=document.createElement("a")),l.href=e,t===l.href}function a(e,...n){if(null==e)return t;const o=e.subscribe(...n);return o.unsubscribe?()=>o.unsubscribe():o}function i(t){return null==t?"":t}function f(t,e){t.appendChild(e)}function p(t,e,n){t.insertBefore(e,n||null)}function d(t){t.parentNode.removeChild(t)}function h(t){return document.createElement(t)}function m(t){return document.createTextNode(t)}function $(){return m(" ")}function y(t,e,n,o){return t.addEventListener(e,n,o),()=>t.removeEventListener(e,n,o)}function g(t){return function(e){return e.preventDefault(),t.call(this,e)}}function v(t,e,n){null==n?t.removeAttribute(e):t.getAttribute(e)!==n&&t.setAttribute(e,n)}function b(t,e){e=""+e,t.wholeText!==e&&(t.data=e)}function k(t,e,n,o){t.style.setProperty(e,n,o?"important":"")}function x(t){c=t}const _=[],w=[],S=[],P=[],A=Promise.resolve();let E=!1;function I(t){S.push(t)}function M(t){P.push(t)}let z=!1;const C=new Set;function T(){if(!z){z=!0;do{for(let t=0;t<_.length;t+=1){const e=_[t];x(e),N(e.$$)}for(x(null),_.length=0;w.length;)w.pop()();for(let t=0;t<S.length;t+=1){const e=S[t];C.has(e)||(C.add(e),e())}S.length=0}while(_.length);for(;P.length;)P.pop()();E=!1,z=!1,C.clear()}}function N(t){if(null!==t.fragment){t.update(),o(t.before_update);const e=t.dirty;t.dirty=[-1],t.fragment&&t.fragment.p(t.ctx,e),t.after_update.forEach(I)}}const W=new Set;function j(t,e){t&&t.i&&(W.delete(t),t.i(e))}function L(t,e,n,o){if(t&&t.o){if(W.has(t))return;W.add(t),undefined.c.push((()=>{W.delete(t),o&&(n&&t.d(1),o())})),t.o(e)}}function D(t,e,n){const o=t.$$.props[e];void 0!==o&&(t.$$.bound[o]=n,n(t.$$.ctx[o]))}function O(t){t&&t.c()}function X(t,n,s,l){const{fragment:c,on_mount:u,on_destroy:a,after_update:i}=t.$$;c&&c.m(n,s),l||I((()=>{const n=u.map(e).filter(r);a?a.push(...n):o(n),t.$$.on_mount=[]})),i.forEach(I)}function q(t,e){const n=t.$$;null!==n.fragment&&(o(n.on_destroy),n.fragment&&n.fragment.d(e),n.on_destroy=n.fragment=null,n.ctx=[])}function B(t,e){-1===t.$$.dirty[0]&&(_.push(t),E||(E=!0,A.then(T)),t.$$.dirty.fill(0)),t.$$.dirty[e/31|0]|=1<<e%31}function H(e,r,s,l,u,a,i,f=[-1]){const p=c;x(e);const h=e.$$={fragment:null,ctx:null,props:a,update:t,not_equal:u,bound:n(),on_mount:[],on_destroy:[],on_disconnect:[],before_update:[],after_update:[],context:new Map(p?p.$$.context:r.context||[]),callbacks:n(),dirty:f,skip_bound:!1,root:r.target||p.$$.root};i&&i(h.root);let m=!1;if(h.ctx=s?s(e,r.props||{},((t,n,...o)=>{const r=o.length?o[0]:n;return h.ctx&&u(h.ctx[t],h.ctx[t]=r)&&(!h.skip_bound&&h.bound[t]&&h.bound[t](r),m&&B(e,t)),n})):[],h.update(),m=!0,o(h.before_update),h.fragment=!!l&&l(h.ctx),r.target){if(r.hydrate){const t=function(t){return Array.from(t.childNodes)}(r.target);h.fragment&&h.fragment.l(t),t.forEach(d)}else h.fragment&&h.fragment.c();r.intro&&j(e.$$.fragment),X(e,r.target,r.anchor,r.customElement),T()}x(p)}class R{$destroy(){q(this,1),this.$destroy=t}$on(t,e){const n=this.$$.callbacks[t]||(this.$$.callbacks[t]=[]);return n.push(e),()=>{const t=n.indexOf(e);-1!==t&&n.splice(t,1)}}$set(t){var e;this.$$set&&(e=t,0!==Object.keys(e).length)&&(this.$$.skip_bound=!0,this.$$set(t),this.$$.skip_bound=!1)}}const F=[];function G(t,e){return{subscribe:J(t,e).subscribe}}function J(e,n=t){let o;const r=new Set;function l(t){if(s(e,t)&&(e=t,o)){const t=!F.length;for(const t of r)t[1](),F.push(t,e);if(t){for(let t=0;t<F.length;t+=2)F[t][0](F[t+1]);F.length=0}}}return{set:l,update:function(t){l(t(e))},subscribe:function(s,c=t){const u=[s,c];return r.add(u),1===r.size&&(o=n(l)||t),s(e),()=>{r.delete(u),0===r.size&&(o(),o=null)}}}}const K=J(5);function Q(t){let e;const n=new XMLHttpRequest;return n.open("GET",t,!1),n.send(null),e=n.responseText,e}function U(e,n,s){return function(e,n,s){const l=!Array.isArray(e),c=l?[e]:e,u=n.length<2;return G(s,(e=>{let s=!1;const i=[];let f=0,p=t;const d=()=>{if(f)return;p();const o=n(l?i[0]:i,e);u?e(o):p=r(o)?o:t},h=c.map(((t,e)=>a(t,(t=>{i[e]=t,f&=~(1<<e),s&&d()}),(()=>{f|=1<<e}))));return s=!0,d(),function(){o(h),p()}}))}([e,n],(([t,e])=>function(t,e,n){const o=parseFloat(t);if(n>o)return 0;const r=o-n,s=Math.floor(r%60);return(30*Math.floor((r-s)/100)+s/2)/e}(t,e,s)))}function V(e){let n,o;return{c(){n=h("img"),v(n,"draggable","false"),u(n.src,o=e[3])||v(n,"src",o),v(n,"alt","Timelapse")},m(t,e){p(t,n,e)},p(t,[e]){8&e&&!u(n.src,o=t[3])&&v(n,"src",o)},i:t,o:t,d(t){t&&d(n)}}}let Y="AllSkyCamImages",Z="WeatherCamImages";function tt(t){return`${String(t).padStart(4,"0")}.jpg`}function et(t){t=function(t){(t=Math.floor(t))%2==1&&(t=parseInt(t-1));return t}(t);const e=String(t).split("");if(e.length>=2){e.pop();const n=e.pop();parseInt(n)>=6&&(t-=60,t+=100)}return t>2400&&(t=0),t}function nt(e,n,o){let r,s,l,c,u=t,i=()=>(u(),u=a(x,(t=>o(10,s=t))),x),f=t,p=t;var d,h;d=K,h=t=>o(9,r=t),e.$$.on_destroy.push(a(d,h)),e.$$.on_destroy.push((()=>u())),e.$$.on_destroy.push((()=>f())),e.$$.on_destroy.push((()=>p()));let m,$,y,g,{paused:v=!0}=n,{time:b}=n,{allsky:k}=n,{totalPlaytime:x}=n;i();const _=1e3/r,w=_/1e3;function S(t){const{subscribe:e,set:n,update:c}=J(m+t);let u;function a(){u=setInterval((()=>{b<s&&(c((t=>function(t,e){t=t.split("/").at(-1),e=e.split("/").at(-1),t=t.split(".")[0],e=e.split(".")[0];let n=parseInt(t)+2,o=parseInt(e);n=et(n),n>=o&&(n=o);let r=tt(n);return`${m}${r}`}(t,l))),o(4,b+=w))}),_)}function i(){clearInterval(u)}function f(t){if(t<0&&(t=0),t<s){let e=m+function(t,e){const n=t*e*2;return tt(et(100*Math.floor(n/60)+Math.floor(n%60)+$))}(t,r);n(e)}}return{subscribe:e,play:()=>a(),pause:()=>i(),seek:t=>f(t),resetStartPoint:()=>function(){i();let t=m+tt($);n(t)}()}}function P(t,e){void 0!==g&&g.pause(),$=e,m=`/images/${t}/`,o(2,y=function(t){return G(Q(t),(function(e){const n=setInterval((async()=>{e(Q(t))}),12e4);return function(){clearInterval(n)}}))}(m+"lastimage")),f(),f=a(y,(t=>o(11,l=t))),i(o(0,x=U(y,K,e))),o(4,b=0)}function A(t,e){P(t,e);const n=tt(e);o(1,g=S(n)),p(),p=a(g,(t=>o(3,c=t)))}return k?($=1200,A(Y,$)):($=500,A(Z,$)),e.$$set=t=>{"paused"in t&&o(5,v=t.paused),"time"in t&&o(4,b=t.time),"allsky"in t&&o(6,k=t.allsky),"totalPlaytime"in t&&i(o(0,x=t.totalPlaytime))},e.$$.update=()=>{66&e.$$.dirty&&(k?(P(Y,1200),g.resetStartPoint()):(P(Z,500),g.resetStartPoint())),34&e.$$.dirty&&(v?g.pause():g.play()),18&e.$$.dirty&&g.seek(b)},[x,g,y,c,b,v,k]}class ot extends R{constructor(t){super(),H(this,t,nt,V,s,{paused:5,time:4,allsky:6,totalPlaytime:0})}}function rt(t){let e,n,r,s,l,c,u,a,i,x,_,S,P,A,E,I,z,C,T,N,W,B,H,R=st(t[1])+"",F=t[2]?"play":"pause",G=st(t[5])+"";function J(e){t[9](e)}function K(e){t[10](e)}let Q={paused:t[2],allsky:t[0]};return void 0!==t[1]&&(Q.time=t[1]),void 0!==t[3]&&(Q.totalPlaytime=t[3]),n=new ot({props:Q}),w.push((()=>D(n,"time",J))),w.push((()=>D(n,"totalPlaytime",K))),{c(){e=h("div"),O(n.$$.fragment),l=$(),c=h("div"),u=h("div"),a=h("span"),i=m(R),x=$(),_=h("span"),S=m("click anywhere to "),P=m(F),A=m(" / drag to seek"),E=$(),I=h("span"),z=m(G),C=$(),T=h("progress"),v(a,"class","time svelte-pv6ez4"),v(_,"class","svelte-pv6ez4"),v(I,"class","time svelte-pv6ez4"),v(u,"class","info svelte-pv6ez4"),T.value=N=t[1]/t[5]||0,v(T,"class","svelte-pv6ez4"),v(c,"class","controls svelte-pv6ez4"),k(c,"opacity",t[5]&&t[4]?1:0),v(e,"class","svelte-pv6ez4")},m(o,r){p(o,e,r),X(n,e,null),f(e,l),f(e,c),f(c,u),f(u,a),f(a,i),f(u,x),f(u,_),f(_,S),f(_,P),f(_,A),f(u,E),f(u,I),f(I,z),f(c,C),f(c,T),W=!0,B||(H=[y(e,"mousemove",t[6]),y(e,"touchmove",g(t[6])),y(e,"mousedown",t[7]),y(e,"touchstart",g(t[7])),y(e,"touchend",g(t[8])),y(e,"mouseup",t[8])],B=!0)},p(t,[e]){const o={};4&e&&(o.paused=t[2]),1&e&&(o.allsky=t[0]),!r&&2&e&&(r=!0,o.time=t[1],M((()=>r=!1))),!s&&8&e&&(s=!0,o.totalPlaytime=t[3],M((()=>s=!1))),n.$set(o),(!W||2&e)&&R!==(R=st(t[1])+"")&&b(i,R),(!W||4&e)&&F!==(F=t[2]?"play":"pause")&&b(P,F),(!W||32&e)&&G!==(G=st(t[5])+"")&&b(z,G),(!W||34&e&&N!==(N=t[1]/t[5]||0))&&(T.value=N),(!W||48&e)&&k(c,"opacity",t[5]&&t[4]?1:0)},i(t){W||(j(n.$$.fragment,t),W=!0)},o(t){L(n.$$.fragment,t),W=!1},d(t){t&&d(e),q(n),B=!1,o(H)}}}function st(t){if(isNaN(t))return"...";const e=Math.floor(t/60);return(t=Math.floor(t%60))<10&&(t="0"+t),`${e}:${t}`}function lt(e,n,o){let r,s=t;e.$$.on_destroy.push((()=>s()));let l,c,u,{allsky:i=!1}=n,f=0,p=!0,d=!0;return e.$$set=t=>{"allsky"in t&&o(0,i=t.allsky)},[i,f,p,l,d,r,function(t){if(clearTimeout(c),c=setTimeout((()=>o(4,d=!1)),2500),o(4,d=!0),!l)return;if("touchmove"!==t.type&&!(1&t.buttons))return;const e="touchmove"===t.type?t.touches[0].clientX:t.clientX,{left:n,right:s}=this.getBoundingClientRect();o(1,f=r*(e-n)/(s-n))},function(t){u=new Date},function(t){new Date-u<300&&o(2,p=!p)},function(t){f=t,o(1,f)},function(t){l=t,o(3,l),s(),s=a(l,(t=>o(5,r=t)))}]}class ct extends R{constructor(t){super(),H(this,t,lt,rt,s,{allsky:0})}}function ut(t){let e,n,o,r,s,l,c,u,a,g,k,x,_,w,S,P,A,E,I,M,z,C,T,N,W=t[0]?"AllSky":"Weather",D=t[0]?"AllSkyCam":"WeatherCam";return k=new ct({props:{allsky:t[0]}}),{c(){e=h("header"),n=h("div"),n.innerHTML='<img src="./uc-rothney.png" class="header-img"/>',o=$(),r=h("div"),s=h("h1"),l=m(W),c=m(" Timelapse"),u=$(),a=h("main"),g=h("div"),O(k.$$.fragment),x=$(),_=h("input"),w=$(),S=h("label"),P=h("h2"),A=m(D),M=$(),z=h("footer"),v(n,"class","left"),v(r,"class","right"),v(e,"class","flex-container row"),v(g,"class","player"),v(_,"type","checkbox"),v(_,"name","allsky"),v(_,"id","allsky"),v(_,"class","svelte-y8xbaa"),v(P,"class",E=i(t[0]?"text-left":"text-right")+" svelte-y8xbaa"),v(S,"for","allsky"),v(S,"class",I=" "+(t[0]?"flex-left":"flex-right")+" svelte-y8xbaa"),v(a,"class","flex-container column")},m(i,d){p(i,e,d),f(e,n),f(e,o),f(e,r),f(r,s),f(s,l),f(s,c),p(i,u,d),p(i,a,d),f(a,g),X(k,g,null),f(a,x),f(a,_),_.checked=t[0],f(a,w),f(a,S),f(S,P),f(P,A),p(i,M,d),p(i,z,d),C=!0,T||(N=y(_,"change",t[1]),T=!0)},p(t,[e]){(!C||1&e)&&W!==(W=t[0]?"AllSky":"Weather")&&b(l,W);const n={};1&e&&(n.allsky=t[0]),k.$set(n),1&e&&(_.checked=t[0]),(!C||1&e)&&D!==(D=t[0]?"AllSkyCam":"WeatherCam")&&b(A,D),(!C||1&e&&E!==(E=i(t[0]?"text-left":"text-right")+" svelte-y8xbaa"))&&v(P,"class",E),(!C||1&e&&I!==(I=" "+(t[0]?"flex-left":"flex-right")+" svelte-y8xbaa"))&&v(S,"class",I)},i(t){C||(j(k.$$.fragment,t),C=!0)},o(t){L(k.$$.fragment,t),C=!1},d(t){t&&d(e),t&&d(u),t&&d(a),q(k),t&&d(M),t&&d(z),T=!1,N()}}}function at(t,e,n){let o=!1;return[o,function(){o=this.checked,n(0,o)}]}return new class extends R{constructor(t){super(),H(this,t,at,ut,s,{})}}({target:document.body,props:{}})}();
