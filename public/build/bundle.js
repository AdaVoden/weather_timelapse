var app=function(){"use strict";function t(){}function e(t){return t()}function n(){return Object.create(null)}function o(t){t.forEach(e)}function s(t){return"function"==typeof t}function r(t,e){return t!=t?e==e:t!==e||t&&"object"==typeof t||"function"==typeof t}let c,l;function u(t,e){return c||(c=document.createElement("a")),c.href=e,t===c.href}function a(e,...n){if(null==e)return t;const o=e.subscribe(...n);return o.unsubscribe?()=>o.unsubscribe():o}function i(t){return null==t?"":t}function f(t,e){t.appendChild(e)}function p(t,e,n){t.insertBefore(e,n||null)}function d(t){t.parentNode.removeChild(t)}function h(t){return document.createElement(t)}function m(t){return document.createTextNode(t)}function $(){return m(" ")}function y(t,e,n,o){return t.addEventListener(e,n,o),()=>t.removeEventListener(e,n,o)}function g(t){return function(e){return e.preventDefault(),t.call(this,e)}}function b(t,e,n){null==n?t.removeAttribute(e):t.getAttribute(e)!==n&&t.setAttribute(e,n)}function v(t,e){e=""+e,t.wholeText!==e&&(t.data=e)}function k(t,e,n,o){t.style.setProperty(e,n,o?"important":"")}function x(t){l=t}const _=[],w=[],S=[],I=[],A=Promise.resolve();let P=!1;function C(t){S.push(t)}function E(t){I.push(t)}let q=!1;const T=new Set;function M(){if(!q){q=!0;do{for(let t=0;t<_.length;t+=1){const e=_[t];x(e),W(e.$$)}for(x(null),_.length=0;w.length;)w.pop()();for(let t=0;t<S.length;t+=1){const e=S[t];T.has(e)||(T.add(e),e())}S.length=0}while(_.length);for(;I.length;)I.pop()();P=!1,q=!1,T.clear()}}function W(t){if(null!==t.fragment){t.update(),o(t.before_update);const e=t.dirty;t.dirty=[-1],t.fragment&&t.fragment.p(t.ctx,e),t.after_update.forEach(C)}}const N=new Set;function j(t,e){t&&t.i&&(N.delete(t),t.i(e))}function L(t,e,n,o){if(t&&t.o){if(N.has(t))return;N.add(t),undefined.c.push((()=>{N.delete(t),o&&(n&&t.d(1),o())})),t.o(e)}}function D(t,e,n){const o=t.$$.props[e];void 0!==o&&(t.$$.bound[o]=n,n(t.$$.ctx[o]))}function O(t){t&&t.c()}function X(t,n,r,c){const{fragment:l,on_mount:u,on_destroy:a,after_update:i}=t.$$;l&&l.m(n,r),c||C((()=>{const n=u.map(e).filter(s);a?a.push(...n):o(n),t.$$.on_mount=[]})),i.forEach(C)}function z(t,e){const n=t.$$;null!==n.fragment&&(o(n.on_destroy),n.fragment&&n.fragment.d(e),n.on_destroy=n.fragment=null,n.ctx=[])}function B(t,e){-1===t.$$.dirty[0]&&(_.push(t),P||(P=!0,A.then(M)),t.$$.dirty.fill(0)),t.$$.dirty[e/31|0]|=1<<e%31}function H(e,s,r,c,u,a,i,f=[-1]){const p=l;x(e);const h=e.$$={fragment:null,ctx:null,props:a,update:t,not_equal:u,bound:n(),on_mount:[],on_destroy:[],on_disconnect:[],before_update:[],after_update:[],context:new Map(p?p.$$.context:s.context||[]),callbacks:n(),dirty:f,skip_bound:!1,root:s.target||p.$$.root};i&&i(h.root);let m=!1;if(h.ctx=r?r(e,s.props||{},((t,n,...o)=>{const s=o.length?o[0]:n;return h.ctx&&u(h.ctx[t],h.ctx[t]=s)&&(!h.skip_bound&&h.bound[t]&&h.bound[t](s),m&&B(e,t)),n})):[],h.update(),m=!0,o(h.before_update),h.fragment=!!c&&c(h.ctx),s.target){if(s.hydrate){const t=function(t){return Array.from(t.childNodes)}(s.target);h.fragment&&h.fragment.l(t),t.forEach(d)}else h.fragment&&h.fragment.c();s.intro&&j(e.$$.fragment),X(e,s.target,s.anchor,s.customElement),M()}x(p)}class R{$destroy(){z(this,1),this.$destroy=t}$on(t,e){const n=this.$$.callbacks[t]||(this.$$.callbacks[t]=[]);return n.push(e),()=>{const t=n.indexOf(e);-1!==t&&n.splice(t,1)}}$set(t){var e;this.$$set&&(e=t,0!==Object.keys(e).length)&&(this.$$.skip_bound=!0,this.$$set(t),this.$$.skip_bound=!1)}}const F=[];function G(t,e){return{subscribe:J(t,e).subscribe}}function J(e,n=t){let o;const s=new Set;function c(t){if(r(e,t)&&(e=t,o)){const t=!F.length;for(const t of s)t[1](),F.push(t,e);if(t){for(let t=0;t<F.length;t+=2)F[t][0](F[t+1]);F.length=0}}}return{set:c,update:function(t){c(t(e))},subscribe:function(r,l=t){const u=[r,l];return s.add(u),1===s.size&&(o=n(c)||t),r(e),()=>{s.delete(u),0===s.size&&(o(),o=null)}}}}const K=J(5);function Q(t){let e;const n=new XMLHttpRequest;return n.open("GET",t,!1),n.send(null),e=n.responseText,e}function U(e,n,r){return function(e,n,r){const c=!Array.isArray(e),l=c?[e]:e,u=n.length<2;return G(r,(e=>{let r=!1;const i=[];let f=0,p=t;const d=()=>{if(f)return;p();const o=n(c?i[0]:i,e);u?e(o):p=s(o)?o:t},h=l.map(((t,e)=>a(t,(t=>{i[e]=t,f&=~(1<<e),r&&d()}),(()=>{f|=1<<e}))));return r=!0,d(),function(){o(h),p()}}))}([e,n],(([t,e])=>function(t,e,n){const o=t.slice(0,4),s=parseFloat(o)-n,r=parseInt(s%60);return(30*parseInt((s-r)/60)+r/2)/e}(t,e,r)))}function V(e){let n,o;return{c(){n=h("img"),b(n,"draggable","false"),u(n.src,o=e[3])||b(n,"src",o),b(n,"alt","Timelapse")},m(t,e){p(t,n,e)},p(t,[e]){8&e&&!u(n.src,o=t[3])&&b(n,"src",o)},i:t,o:t,d(t){t&&d(n)}}}function Y(t){return`${String(t).padStart(4,"0")}.jpg`}function Z(t){t=function(t){(t=Math.floor(t))%2==1&&(t=parseInt(t-1));return t}(t);const e=String(t).split("");if(e.length>=2){e.pop();const n=e.pop();parseInt(n)>=6&&(t-=60,t+=100)}return t>2400&&(t=0),t}function tt(e,n,o){let s,r,c,l,u=t,i=()=>(u(),u=a(x,(t=>o(10,r=t))),x),f=t,p=t;var d,h;d=K,h=t=>o(9,s=t),e.$$.on_destroy.push(a(d,h)),e.$$.on_destroy.push((()=>u())),e.$$.on_destroy.push((()=>f())),e.$$.on_destroy.push((()=>p()));let m,$,y,g,{paused:b}=n,{time:v=0}=n,{allsky:k}=n,{totalPlaytime:x}=n;i();const _=1e3/s,w=_/1e3;function S(t){const{subscribe:e,set:n,update:l}=J(m+t);let u;function a(){u=setInterval((()=>{v<r&&(l((t=>function(t,e){t=t.split("/").at(-1),e=e.split("/").at(-1),t=t.split(".")[0],e=e.split(".")[0];let n=parseInt(t)+2,o=parseInt(e);n=Z(n),n>=o&&(n=o);let s=Y(n);return`${m}${s}`}(t,c))),o(5,v+=w))}),_)}function i(){o(4,b=!0),clearInterval(u)}function f(t){t<0&&(t=0);let e=m+function(t,e,n){return Y(Z(t/e*(e*n*2)+$))}(t,r,s);n(e)}return{subscribe:e,play:()=>a(),pause:()=>i(),seek:t=>f(t),resetStartPoint:()=>function(){i();let t=m+Y($);n(t)}()}}function I(t,e){void 0!==g&&g.pause(),$=e,m=`/images/${t}/`,o(2,y=function(t){return G(Q(t),(function(e){const n=setInterval((async()=>{e(Q(t))}),12e4);return function(){clearInterval(n)}}))}(m+"lastimage")),f(),f=a(y,(t=>o(11,c=t))),i(o(0,x=U(y,K,e))),o(5,v=0)}function A(t,e){I(t,e);const n=Y(e);o(1,g=S(n)),p(),p=a(g,(t=>o(3,l=t)))}return k?($=1200,A("AllSkyCamImages",$)):($=0,A("WeatherCamImages",$)),e.$$set=t=>{"paused"in t&&o(4,b=t.paused),"time"in t&&o(5,v=t.time),"allsky"in t&&o(6,k=t.allsky),"totalPlaytime"in t&&i(o(0,x=t.totalPlaytime))},e.$$.update=()=>{66&e.$$.dirty&&(k?(I("AllSkyCamImages",1200),g.resetStartPoint()):(I("WeatherCamImages",0),g.resetStartPoint())),18&e.$$.dirty&&(b?g.pause():g.play()),34&e.$$.dirty&&g.seek(v)},[x,g,y,l,b,v,k]}class et extends R{constructor(t){super(),H(this,t,tt,V,r,{paused:4,time:5,allsky:6,totalPlaytime:0})}}function nt(t){let e,n,s,r,c,l,u,a,i,x,_,S,I,A,P,C,q,T,M,W,N,B,H,R,F=ot(t[1])+"",G=t[2]?"play":"pause",J=ot(t[5])+"";function K(e){t[9](e)}function Q(e){t[10](e)}function U(e){t[11](e)}let V={allsky:t[0]};return void 0!==t[2]&&(V.paused=t[2]),void 0!==t[1]&&(V.time=t[1]),void 0!==t[3]&&(V.totalPlaytime=t[3]),n=new et({props:V}),w.push((()=>D(n,"paused",K))),w.push((()=>D(n,"time",Q))),w.push((()=>D(n,"totalPlaytime",U))),{c(){e=h("div"),O(n.$$.fragment),l=$(),u=h("div"),a=h("div"),i=h("span"),x=m(F),_=$(),S=h("span"),I=m("click anywhere to "),A=m(G),P=m(" / drag to seek"),C=$(),q=h("span"),T=m(J),M=$(),W=h("progress"),b(i,"class","time svelte-13cfdq"),b(S,"class","svelte-13cfdq"),b(q,"class","time svelte-13cfdq"),b(a,"class","info svelte-13cfdq"),W.value=N=t[1]/t[5]||0,b(W,"class","svelte-13cfdq"),b(u,"class","controls svelte-13cfdq"),k(u,"opacity",t[5]&&t[4]?1:0),b(e,"class","svelte-13cfdq")},m(o,s){p(o,e,s),X(n,e,null),f(e,l),f(e,u),f(u,a),f(a,i),f(i,x),f(a,_),f(a,S),f(S,I),f(S,A),f(S,P),f(a,C),f(a,q),f(q,T),f(u,M),f(u,W),B=!0,H||(R=[y(e,"mousemove",t[6]),y(e,"touchmove",g(t[6])),y(e,"mousedown",t[7]),y(e,"touchstart",g(t[7])),y(e,"touchend",g(t[8])),y(e,"mouseup",t[8])],H=!0)},p(t,[e]){const o={};1&e&&(o.allsky=t[0]),!s&&4&e&&(s=!0,o.paused=t[2],E((()=>s=!1))),!r&&2&e&&(r=!0,o.time=t[1],E((()=>r=!1))),!c&&8&e&&(c=!0,o.totalPlaytime=t[3],E((()=>c=!1))),n.$set(o),(!B||2&e)&&F!==(F=ot(t[1])+"")&&v(x,F),(!B||4&e)&&G!==(G=t[2]?"play":"pause")&&v(A,G),(!B||32&e)&&J!==(J=ot(t[5])+"")&&v(T,J),(!B||34&e&&N!==(N=t[1]/t[5]||0))&&(W.value=N),(!B||48&e)&&k(u,"opacity",t[5]&&t[4]?1:0)},i(t){B||(j(n.$$.fragment,t),B=!0)},o(t){L(n.$$.fragment,t),B=!1},d(t){t&&d(e),z(n),H=!1,o(R)}}}function ot(t){if(isNaN(t))return"...";const e=Math.floor(t/60);return(t=Math.floor(t%60))<10&&(t="0"+t),`${e}:${t}`}function st(e,n,o){let s,r=t;e.$$.on_destroy.push((()=>r()));let c,l,u,{allsky:i=!1}=n,f=0,p=!0,d=!0;return e.$$set=t=>{"allsky"in t&&o(0,i=t.allsky)},[i,f,p,c,d,s,function(t){if(clearTimeout(l),l=setTimeout((()=>o(4,d=!1)),2500),o(4,d=!0),!c)return;if("touchmove"!==t.type&&!(1&t.buttons))return;const e="touchmove"===t.type?t.touches[0].clientX:t.clientX,{left:n,right:r}=this.getBoundingClientRect();o(1,f=s*(e-n)/(r-n))},function(t){u=new Date},function(t){new Date-u<300&&o(2,p=!p)},function(t){p=t,o(2,p)},function(t){f=t,o(1,f)},function(t){c=t,o(3,c),r(),r=a(c,(t=>o(5,s=t)))}]}class rt extends R{constructor(t){super(),H(this,t,st,nt,r,{allsky:0})}}function ct(t){let e,n,o,s,r,c,l,u,a,g,k,x,_,w,S,I,A,P,C,E,q,T,M,W,N=t[0]?"AllSky":"Weather",D=t[0]?"AllSkyCam":"WeatherCam";return k=new rt({props:{allsky:t[0]}}),{c(){e=h("header"),n=h("div"),n.innerHTML='<img src="./uc-rothney.png" class="header-img"/>',o=$(),s=h("div"),r=h("h1"),c=m(N),l=m(" Timelapse"),u=$(),a=h("main"),g=h("div"),O(k.$$.fragment),x=$(),_=h("input"),w=$(),S=h("label"),I=h("h2"),A=m(D),E=$(),q=h("footer"),b(n,"class","left"),b(s,"class","right"),b(e,"class","flex-container row"),b(g,"class","player"),b(_,"type","checkbox"),b(_,"name","allsky"),b(_,"id","allsky"),b(_,"class","svelte-y8xbaa"),b(I,"class",P=i(t[0]?"text-left":"text-right")+" svelte-y8xbaa"),b(S,"for","allsky"),b(S,"class",C=" "+(t[0]?"flex-left":"flex-right")+" svelte-y8xbaa"),b(a,"class","flex-container column")},m(i,d){p(i,e,d),f(e,n),f(e,o),f(e,s),f(s,r),f(r,c),f(r,l),p(i,u,d),p(i,a,d),f(a,g),X(k,g,null),f(a,x),f(a,_),_.checked=t[0],f(a,w),f(a,S),f(S,I),f(I,A),p(i,E,d),p(i,q,d),T=!0,M||(W=y(_,"change",t[1]),M=!0)},p(t,[e]){(!T||1&e)&&N!==(N=t[0]?"AllSky":"Weather")&&v(c,N);const n={};1&e&&(n.allsky=t[0]),k.$set(n),1&e&&(_.checked=t[0]),(!T||1&e)&&D!==(D=t[0]?"AllSkyCam":"WeatherCam")&&v(A,D),(!T||1&e&&P!==(P=i(t[0]?"text-left":"text-right")+" svelte-y8xbaa"))&&b(I,"class",P),(!T||1&e&&C!==(C=" "+(t[0]?"flex-left":"flex-right")+" svelte-y8xbaa"))&&b(S,"class",C)},i(t){T||(j(k.$$.fragment,t),T=!0)},o(t){L(k.$$.fragment,t),T=!1},d(t){t&&d(e),t&&d(u),t&&d(a),z(k),t&&d(E),t&&d(q),M=!1,W()}}}function lt(t,e,n){let o=!1;return[o,function(){o=this.checked,n(0,o)}]}return new class extends R{constructor(t){super(),H(this,t,lt,ct,r,{})}}({target:document.body,props:{}})}();
