var app=function(){"use strict";function t(){}function e(t){return t()}function n(){return Object.create(null)}function o(t){t.forEach(e)}function r(t){return"function"==typeof t}function s(t,e){return t!=t?e==e:t!==e||t&&"object"==typeof t||"function"==typeof t}let c,u;function a(t,e){return c||(c=document.createElement("a")),c.href=e,t===c.href}function i(e,...n){if(null==e)return t;const o=e.subscribe(...n);return o.unsubscribe?()=>o.unsubscribe():o}function l(t,e,n){t.$$.on_destroy.push(i(e,n))}function f(t,e){t.appendChild(e)}function d(t,e,n){t.insertBefore(e,n||null)}function p(t){t.parentNode.removeChild(t)}function m(t){return document.createElement(t)}function h(t){return document.createTextNode(t)}function g(){return h(" ")}function $(t,e,n,o){return t.addEventListener(e,n,o),()=>t.removeEventListener(e,n,o)}function v(t,e,n){null==n?t.removeAttribute(e):t.getAttribute(e)!==n&&t.setAttribute(e,n)}function b(t,e){e=""+e,t.wholeText!==e&&(t.data=e)}function y(t,e,n,o){t.style.setProperty(e,n,o?"important":"")}function x(t){u=t}const _=[],I=[],w=[],k=[],q=Promise.resolve();let E=!1;function L(t){w.push(t)}let T=!1;const R=new Set;function A(){if(!T){T=!0;do{for(let t=0;t<_.length;t+=1){const e=_[t];x(e),j(e.$$)}for(x(null),_.length=0;I.length;)I.pop()();for(let t=0;t<w.length;t+=1){const e=w[t];R.has(e)||(R.add(e),e())}w.length=0}while(_.length);for(;k.length;)k.pop()();E=!1,T=!1,R.clear()}}function j(t){if(null!==t.fragment){t.update(),o(t.before_update);const e=t.dirty;t.dirty=[-1],t.fragment&&t.fragment.p(t.ctx,e),t.after_update.forEach(L)}}const C=new Set;function S(t,e){t&&t.i&&(C.delete(t),t.i(e))}function M(t,n,s,c){const{fragment:u,on_mount:a,on_destroy:i,after_update:l}=t.$$;u&&u.m(n,s),c||L((()=>{const n=a.map(e).filter(r);i?i.push(...n):o(n),t.$$.on_mount=[]})),l.forEach(L)}function N(t,e){const n=t.$$;null!==n.fragment&&(o(n.on_destroy),n.fragment&&n.fragment.d(e),n.on_destroy=n.fragment=null,n.ctx=[])}function U(t,e){-1===t.$$.dirty[0]&&(_.push(t),E||(E=!0,q.then(A)),t.$$.dirty.fill(0)),t.$$.dirty[e/31|0]|=1<<e%31}function O(e,r,s,c,a,i,l,f=[-1]){const d=u;x(e);const m=e.$$={fragment:null,ctx:null,props:i,update:t,not_equal:a,bound:n(),on_mount:[],on_destroy:[],on_disconnect:[],before_update:[],after_update:[],context:new Map(d?d.$$.context:r.context||[]),callbacks:n(),dirty:f,skip_bound:!1,root:r.target||d.$$.root};l&&l(m.root);let h=!1;if(m.ctx=s?s(e,r.props||{},((t,n,...o)=>{const r=o.length?o[0]:n;return m.ctx&&a(m.ctx[t],m.ctx[t]=r)&&(!m.skip_bound&&m.bound[t]&&m.bound[t](r),h&&U(e,t)),n})):[],m.update(),h=!0,o(m.before_update),m.fragment=!!c&&c(m.ctx),r.target){if(r.hydrate){const t=function(t){return Array.from(t.childNodes)}(r.target);m.fragment&&m.fragment.l(t),t.forEach(p)}else m.fragment&&m.fragment.c();r.intro&&S(e.$$.fragment),M(e,r.target,r.anchor,r.customElement),A()}x(d)}class W{$destroy(){N(this,1),this.$destroy=t}$on(t,e){const n=this.$$.callbacks[t]||(this.$$.callbacks[t]=[]);return n.push(e),()=>{const t=n.indexOf(e);-1!==t&&n.splice(t,1)}}$set(t){var e;this.$$set&&(e=t,0!==Object.keys(e).length)&&(this.$$.skip_bound=!0,this.$$set(t),this.$$.skip_bound=!1)}}const D=[];function X(t,e){return{subscribe:z(t,e).subscribe}}function z(e,n=t){let o;const r=new Set;function c(t){if(s(e,t)&&(e=t,o)){const t=!D.length;for(const t of r)t[1](),D.push(t,e);if(t){for(let t=0;t<D.length;t+=2)D[t][0](D[t+1]);D.length=0}}}return{set:c,update:function(t){c(t(e))},subscribe:function(s,u=t){const a=[s,u];return r.add(a),1===r.size&&(o=n(c)||t),s(e),()=>{r.delete(a),0===r.size&&(o(),o=null)}}}}let B="images/WeatherCamImages/lastimage";const H=z(10);function P(t){let e;const n=new XMLHttpRequest;return n.open("GET",t,!1),n.send(null),e=n.responseText,e}const F=X(P(B),(function(t){const e=setInterval((async()=>{t(P(B))}),12e4);return function(){clearInterval(e)}}));const G=function(e,n,s){const c=!Array.isArray(e),u=c?[e]:e,a=n.length<2;return X(s,(e=>{let s=!1;const l=[];let f=0,d=t;const p=()=>{if(f)return;d();const o=n(c?l[0]:l,e);a?e(o):d=r(o)?o:t},m=u.map(((t,e)=>i(t,(t=>{l[e]=t,f&=~(1<<e),s&&p()}),(()=>{f|=1<<e}))));return s=!0,p(),function(){o(m),d()}}))}([F,H],(([t,e])=>function(t,e){const n=t,o=parseInt(n.slice(1)),r=parseInt(n.slice(0,2));return parseFloat((60*r+o)/2)/e}(t,e)));function J(e){let n,r,s,c,u,i,l,x,_,I,w,k,q,E,L,T,R,A,j,C,S=Q(e[1])+"",M=e[0]?"play":"pause";return{c(){n=m("div"),r=m("img"),c=g(),u=m("div"),i=m("div"),l=m("span"),x=h(S),_=g(),I=m("span"),w=h("click anywhere to "),k=h(M),q=h(" / drag to seek"),E=g(),L=m("span"),L.textContent=`${Q(e[4])}`,T=g(),R=m("progress"),v(r,"draggable","false"),a(r.src,s=e[3])||v(r,"src",s),v(r,"class","svelte-13cfdq"),v(l,"class","time svelte-13cfdq"),v(I,"class","svelte-13cfdq"),v(L,"class","time svelte-13cfdq"),v(i,"class","info svelte-13cfdq"),R.value=A=e[1]/e[4]||0,v(R,"class","svelte-13cfdq"),v(u,"class","controls svelte-13cfdq"),y(u,"opacity",e[4]&&e[2]?1:0),v(n,"class","svelte-13cfdq")},m(t,o){var s;d(t,n,o),f(n,r),f(n,c),f(n,u),f(u,i),f(i,l),f(l,x),f(i,_),f(i,I),f(I,w),f(I,k),f(I,q),f(i,E),f(i,L),f(u,T),f(u,R),j||(C=[$(r,"mousemove",e[6]),$(r,"touchmove",(s=e[6],function(t){return t.preventDefault(),s.call(this,t)})),$(r,"mousedown",e[7]),$(r,"mouseup",e[8])],j=!0)},p(t,[e]){8&e&&!a(r.src,s=t[3])&&v(r,"src",s),2&e&&S!==(S=Q(t[1])+"")&&b(x,S),1&e&&M!==(M=t[0]?"play":"pause")&&b(k,M),2&e&&A!==(A=t[1]/t[4]||0)&&(R.value=A),4&e&&y(u,"opacity",t[4]&&t[2]?1:0)},i:t,o:t,d(t){t&&p(n),j=!1,o(C)}}}let K="/images/WeatherCamImages/";function Q(t){if(isNaN(t))return"...";const e=Math.floor(t/60);return(t=Math.floor(t%60))<10&&(t="0"+t),`${e}:${t}`}function V(t,e,n){let o,r,s,c;l(t,H,(t=>n(11,o=t))),l(t,F,(t=>n(12,r=t))),l(t,G,(t=>n(13,s=t)));let u=!0,a=0,i=s;const f=1e3/o,d=f/1e3;let p,m,h=!0;const g=function(){const{subscribe:t,set:e,update:s}=z(K+"0000.jpg");let c;function u(){c=setInterval((()=>{a<i&&(s((t=>function(t,e){t=t.split("/").at(-1),console.log(t),t=t.split(".")[0],e=e.split(".")[0];let n,o=parseInt(t)+2,r=parseInt(e);return(o-60)%100==0&&0!==o&&(o-=60,o+=100),o>=r&&(o=r),n=""+o,n=`${K}${n.padStart(4,"0")}.jpg`,n}(t,r))),n(1,a+=d))}),f)}function l(t){t<0&&(t=0);let n=K+function(t,e,n){const o=t/e*(e*n*2);let r=parseInt(o%60);r%2==1&&(r-=1);const s=parseInt((o-r)/60),c=(""+r).padStart(2,"0");return(""+s).padStart(2,"0")+c+".jpg"}(t,i,o);e(n)}return{subscribe:t,play:()=>u(),pause:()=>{clearInterval(c)},seek:t=>l(t)}}();return l(t,g,(t=>n(3,c=t))),[u,a,h,c,i,g,function(t){if(clearTimeout(p),p=setTimeout((()=>n(2,h=!1)),2500),n(2,h=!0),!i)return;if("touchmove"!==t.type&&!(1&t.buttons))return;const e="touchmove"===t.type?t.touches[0].clientX:t.clientX,{left:o,right:r}=this.getBoundingClientRect();n(1,a=i*(e-o)/(r-o)),g.seek(a)},function(t){m=new Date},function(t){new Date-m<300&&(u?(n(0,u=!1),g.play()):(n(0,u=!0),g.pause()))}]}class Y extends W{constructor(t){super(),O(this,t,V,J,s,{})}}function Z(e){let n,o,r,s,c,u,a,i,l,h;return a=new Y({}),{c(){var t;n=m("link"),o=g(),r=m("header"),r.innerHTML='<div class="left"><h1>Rothney Astrophysical Observatory</h1></div>  \n\n        <div class="right"><h1>Weather Timelapse</h1></div>',s=g(),c=m("main"),u=m("div"),(t=a.$$.fragment)&&t.c(),i=g(),l=m("footer"),document.title=" Weather Timelapse ",v(n,"rel","icon"),v(n,"type","image/x-icon"),v(n,"href","favicon.ico"),v(r,"class","flex-container row"),v(u,"class","player"),v(c,"class","flex-container column")},m(t,e){f(document.head,n),d(t,o,e),d(t,r,e),d(t,s,e),d(t,c,e),f(c,u),M(a,u,null),d(t,i,e),d(t,l,e),h=!0},p:t,i(t){h||(S(a.$$.fragment,t),h=!0)},o(t){!function(t,e,n,o){if(t&&t.o){if(C.has(t))return;C.add(t),(void 0).c.push((()=>{C.delete(t),o&&(n&&t.d(1),o())})),t.o(e)}}(a.$$.fragment,t),h=!1},d(t){p(n),t&&p(o),t&&p(r),t&&p(s),t&&p(c),N(a),t&&p(i),t&&p(l)}}}function tt(t,e,n){let{latestImageURL:o}=e;return t.$$set=t=>{"latestImageURL"in t&&n(0,o=t.latestImageURL)},[o]}return new class extends W{constructor(t){super(),O(this,t,tt,Z,s,{latestImageURL:0})}}({target:document.body,props:{latestImageURL:"http://136.159.57.131/weatherimages/lastimage"}})}();
//# sourceMappingURL=bundle.js.map
